{% comment %} Author: Oju {% endcomment %}
{% comment %} HTMX: This partial file displays the user's buddy list. Each item has a "Remove" button that uses an HTMX POST request to remove the buddy from the list without a page reload. It also displays real-time online status dots. {% endcomment %}

<ul class="styled-list" id="buddy-list">
  {% for buddy in buddy_list %}
    <li id="buddy-{{ buddy.pk }}" class="buddy-list-item user-presence-container" data-user-pk="{{ buddy.pk }}">
      <div class="buddy-info">
        {% if buddy.profile.main_image_url %}
          <img src="{{ buddy.profile.main_image_url }}" alt="{{ buddy.first_name }}" class="buddy-list-avatar">
        {% else %}
          <div class="buddy-list-avatar-placeholder">
            <span>{{ buddy.first_name.0 }}</span>
          </div>
        {% endif %}
        <a href="{% url 'profile' pk=buddy.pk %}" class="user-name"> {{ buddy.first_name }} {{ buddy.last_name }}<span class="online-indicator"></span></a>
      </div>
      <form hx-post="{% url 'remove_buddy' pk=buddy.pk %}" 
            hx-target="#buddy-{{ buddy.pk }}" 
            hx-swap="outerHTML" 
            hx-confirm="Are you sure you want to remove {{ buddy.first_name }} as a buddy?">
        {% csrf_token %}
        <button type="submit" class="btn btn-secondary btn-sm btn-danger">Remove</button>
      </form>
    </li>
  {% endfor %}
</ul>
