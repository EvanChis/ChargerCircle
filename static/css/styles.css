/* Central Design Tokens */
:root {
  --u-primary-rgb: 0, 95, 184;
  --u-accent-rgb: 0, 201, 255;
  --u-secondary-rgb: 108, 43, 217;
  --u-bg-dark-rgb: 18, 24, 30;
  --u-ink-inv-rgb: 248, 250, 252;
  --header-bg-rgb: 28, 36, 46;
  --card-bg-rgb: 34, 42, 54;
  --online-green-rgb: 4, 184, 94;
}

/* Light Mode Theme Definition */
body.light-mode {
  --u-bg-dark-rgb: 248, 250, 252;   /* Light background */
  --u-ink-inv-rgb: 18, 24, 30;       /* Dark text */
  --header-bg-rgb: 255, 255, 255;    /* White header */
  --card-bg-rgb: 229, 231, 235;    /* Light gray cards */
}


/* General Body Styles */
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  background-color: rgba(var(--u-bg-dark-rgb), 1);
  color: rgba(var(--u-ink-inv-rgb), 0.9);
  margin: 0;
  padding-top: 60px;
  transition: background-color 200ms ease-in-out, color 200ms ease-in-out; /* Sexy fade */
}

/* Utility Class */
.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Header and Navigation Styles */
.main-header { position: fixed; top: 0; left: 0; width: 100%; background-color: rgba(var(--header-bg-rgb), 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-bottom: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); z-index: 1000; height: 60px; }
.main-nav { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; display: flex; justify-content: space-between; align-items: center; height: 100%; }
.nav-brand { font-weight: 700; font-size: 1.25rem; color: rgba(var(--u-ink-inv-rgb), 1); text-decoration: none; }
.main-nav ul { list-style: none; margin: 0; padding: 0; display: flex; gap: 1.5rem; align-items: center; }
.main-nav a { color: rgba(var(--u-ink-inv-rgb), 0.8); text-decoration: none; font-weight: 500; transition: color 150ms ease; }
.main-nav a:hover { color: rgba(var(--u-accent-rgb), 1); }

.logged-out-header { padding: 1.5rem; text-align: center; }
.logged-out-header a { font-weight: 700; font-size: 1.25rem; color: rgba(var(--u-ink-inv-rgb), 0.8); text-decoration: none; transition: color 150ms ease; }
.logged-out-header a:hover { color: rgba(var(--u-accent-rgb), 1); }

/* Main Content Area */
main { padding: 0; }
body.logged-out main { padding: 2rem 1.5rem; }
.content-wrapper { max-width: 800px; margin: 2rem auto; text-align: left; padding: 0 1.5rem; }
.content-wrapper h2, .content-wrapper h3 { font-size: 2.5rem; color: rgba(var(--u-accent-rgb), 1); border-bottom: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
.content-wrapper h3 { font-size: 1.5rem; margin-top: 2rem; }
.content-wrapper.center-text { text-align: center; }

/* Card Style */
.card { background: rgba(var(--card-bg-rgb), 0.5); border: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; }
.card strong { color: rgba(var(--u-ink-inv-rgb), 1); font-size: 1.2rem; }
.card em { color: rgba(var(--u-accent-rgb), 0.9); }

/* Form Styles */
.form-group { margin-bottom: 1.5rem; }
form label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: rgba(var(--u-ink-inv-rgb), 0.8); }
.form-text { display: block; font-size: 0.9rem; color: rgba(var(--u-ink-inv-rgb), 0.6); margin-top: 0.5rem; }
form input[type="text"], form input[type="email"], form input[type="password"], form input[type="number"], form textarea, form select { width: 100%; box-sizing: border-box; background-color: rgba(var(--u-bg-dark-rgb), 0.8); border: 1px solid rgba(var(--u-ink-inv-rgb), 0.2); border-radius: 8px; padding: 0.75rem; color: rgba(var(--u-ink-inv-rgb), 1); font-size: 1rem; }
form input[type="number"] { -moz-appearance: textfield; appearance: textfield; }
form input[type="number"]::-webkit-outer-spin-button, form input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
form select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; }
form ul { list-style: none; padding: 0; margin: 0; }
form ul li { margin-bottom: 0.5rem; }
form textarea { min-height: 120px; }

/* List Styles */
.styled-list { list-style: none; padding: 0; }
.styled-list li { padding: 1rem; border-radius: 8px; margin-bottom: 0.5rem; background-color: rgba(var(--card-bg-rgb), 0.3); display: flex; justify-content: space-between; align-items: center; }
.styled-list a { font-size: 1.1rem; font-weight: 600; text-decoration: none; color: rgba(var(--u-ink-inv-rgb), 0.9); }
.styled-list a:hover { color: rgba(var(--u-accent-rgb), 1); }
.styled-list .meta { font-size: 0.9rem; color: rgba(var(--u-ink-inv-rgb), 0.6); }

/* Course Tag Style */
.course-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; }
.course-tag { display: inline-block; background-color: rgba(var(--u-primary-rgb), 0.2); color: rgba(var(--u-accent-rgb), 1); padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.85rem; font-weight: 500; text-decoration: none; border: 1px solid rgba(var(--u-primary-rgb), 0.5); }
.course-tag:hover { background-color: rgba(var(--u-primary-rgb), 0.4); }

/* Online Presence Indicator */
.online-indicator { display: inline-block; margin-left: 0.5rem; width: 10px; height: 10px; background-color: rgba(var(--online-green-rgb), 1); border-radius: 50%; box-shadow: 0 0 8px rgba(var(--online-green-rgb), 0.8); animation: pulse 2s infinite; }
@keyframes pulse { 0% { box-shadow: 0 0 8px rgba(var(--online-green-rgb), 0.8); } 50% { box-shadow: 0 0 12px 3px rgba(var(--online-green-rgb), 0.5); } 100% { box-shadow: 0 0 8px rgba(var(--online-green-rgb), 0.8); } }

/* Homepage Styles */
.home-container { display: grid; place-content: center; min-height: 90vh; text-align: center; }
.home-container .subtitle { font-size: 1.25rem; color: rgba(var(--u-ink-inv-rgb), 0.7); max-width: 500px; margin: 1rem auto 2rem; }

/* Kinetic Gradient Style */
.kinetic-gradient { font-size: 4rem; font-weight: 800; background: linear-gradient(90deg, rgba(var(--u-primary-rgb), 1), rgba(var(--u-accent-rgb), 1), rgba(var(--u-secondary-rgb), 1), rgba(var(--u-primary-rgb), 1)); background-size: 200% auto; color: #fff; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: gradient-flow 30s ease infinite; }
@keyframes gradient-flow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

/* Button Styles */
.cta-buttons { display: flex; flex-direction: column; align-items: center; gap: 1rem; }
.cta-buttons .btn { width: 100%; max-width: 250px; }
.btn { display: inline-block; padding: 0.75rem 1.5rem; border-radius: 999px; text-decoration: none; font-weight: 600; background-color: rgba(var(--u-ink-inv-rgb), 0.1); color: rgba(var(--u-ink-inv-rgb), 0.9); transition: transform 150ms ease-out; cursor: pointer; border: none; }
.btn:hover { transform: scale(1.05); }
.btn.btn-primary { background-color: rgba(var(--u-primary-rgb), 1); color: white; }
button.btn { font-size: 1rem; }
.btn-secondary { background-color: rgba(var(--card-bg-rgb), 0.8); color: rgba(var(--u-ink-inv-rgb), 0.7); padding: 0.5rem 1rem; font-size: 0.9rem; }
.btn-secondary:hover { background-color: rgba(var(--card-bg-rgb), 1); color: rgba(var(--u-ink-inv-rgb), 0.9); }

/* Toast Notification Styles */
#toast-container { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 1050; display: flex; flex-direction: column; gap: 0.5rem; }
.toast { background: rgba(30, 35, 45, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); color: rgba(var(--u-ink-inv-rgb), 0.95); padding: 1rem 1.5rem; border-radius: 8px; border: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); box-shadow: 0 10px 30px rgba(0,0,0,0.2); opacity: 0; transform: translateY(20px); transition: opacity 300ms ease, transform 300ms ease; }
.toast.show { opacity: 1; transform: translateY(0); }

/* Messaging Layout Styles */
.messaging-container { display: flex; height: calc(100vh - 60px); }
.buddy-list-sidebar { width: 300px; border-right: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); padding: 1rem; background-color: rgba(var(--header-bg-rgb), 0.5); overflow-y: auto; }
.buddy-list-sidebar h3 { margin-top: 0; }
.buddy-list-sidebar .styled-list li { background-color: transparent; padding: 0.75rem; }
.buddy-list-sidebar .styled-list li.active { background-color: rgba(var(--u-primary-rgb), 0.2); }
.chat-window { flex: 1; display: flex; flex-direction: column; }
.chat-header { padding: 1rem; border-bottom: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); max-width: 900px; width: 100%; margin: 0 auto; box-sizing: border-box;}
.chat-header h4 { margin: 0; font-size: 1.2rem; }
.chat-header .typing-indicator { font-size: 0.85rem; color: rgba(var(--u-ink-inv-rgb), 0.6); height: 1.2em; }
.message-list { flex: 1; padding: 1.5rem; overflow-y: auto; display: flex; flex-direction: column; gap: 1rem; max-width: 900px; width: 100%; margin: 0 auto; }
.message { max-width: 70%; padding: 0.75rem 1.25rem; border-radius: 18px; line-height: 1.5; }
.message p { margin: 0; }
.message.sent { background-color: rgba(var(--u-primary-rgb), 1); color: white; border-bottom-right-radius: 4px; align-self: flex-end; }
.message.received { background-color: rgba(var(--card-bg-rgb), 1); border-bottom-left-radius: 4px; align-self: flex-start; }
.no-chat-selected { display: grid; place-content: center; height: 100%; color: rgba(var(--u-ink-inv-rgb), 0.5); }
.chat-form-container { padding: 1rem; border-top: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); max-width: 900px; width: 100%; margin: 0 auto; box-sizing: border-box;}
.chat-form-container form { display: flex; gap: 1rem; }
.chat-form-container .message-input { flex: 1; }

/* Profile Picture Gallery */
.image-gallery { display: flex; flex-wrap: wrap; gap: 1.5rem; }
.image-thumbnail-container { position: relative; display: flex; flex-direction: column; gap: 0.5rem; }
.profile-image-thumb { width: 120px; height: 120px; object-fit: cover; border-radius: 8px; border: 3px solid transparent; transition: border-color 200ms ease; }
.profile-image-thumb.is-main { border-color: rgba(var(--u-primary-rgb), 1); box-shadow: 0 0 15px rgba(var(--u-primary-rgb), 0.5); }
.image-actions { display: flex; flex-direction: column; gap: 0.5rem; align-items: center; }
.btn-sm { padding: 0.25rem 0.75rem; font-size: 0.8rem; }
.btn-danger { background-color: #581c1c; color: #fecaca; }
.btn-danger:hover { background-color: #7f1d1d; color: #fee2e2; }

/* Nav Profile Picture */
.nav-profile-pic { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(var(--u-ink-inv-rgb), 0.2); vertical-align: middle; transition: transform 150ms ease; }
.nav-profile-pic:hover { transform: scale(1.1); }

/* Public Profile Page */
.profile-header { display: flex; gap: 2rem; align-items: flex-start; margin-bottom: 1rem; }
.profile-main-image { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid rgba(var(--card-bg-rgb), 1); flex-shrink: 0; }
.profile-main-image-placeholder { width: 150px; height: 150px; border-radius: 50%; background-color: rgba(var(--card-bg-rgb), 1); display: grid; place-content: center; font-size: 4rem; font-weight: 700; color: rgba(var(--u-primary-rgb), 1); flex-shrink: 0; }
.profile-info { display: flex; align-items: baseline; gap: 1rem; flex-wrap: wrap; }
.profile-info h2 { margin-top: 0; border: none; margin-bottom: 0.5rem; }
.profile-bio { font-size: 1.1rem; color: rgba(var(--u-ink-inv-rgb), 0.7); margin-top: 0; margin-bottom: 1.5rem; flex-basis: 100%; }

/* Course Room / Thread Posts */
.post-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; color: rgba(var(--u-ink-inv-rgb), 0.7); }
.post-actions { display: flex; gap: 0.5rem; }
.post-content { padding-left: 0.5rem; }

/* Checkbox Group for Profile Edit */
.checkbox-group ul { list-style: none; padding: 0; columns: 2; -webkit-columns: 2; -moz-columns: 2; }
.checkbox-group li { display: block; }
.checkbox-group label { display: inline-block; margin-left: 0.5rem; }
.checkbox-group input[type="checkbox"] { width: auto; }

/* Logout Section */
.logout-section { margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid rgba(var(--card-bg-rgb), 1); text-align: center; }

/* Buddy Select Pills */
.buddy-select-pills { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.buddy-pill input[type="checkbox"] { display: none; }
.buddy-pill label { display: inline-block; padding: 0.5rem 1rem; border-radius: 999px; background-color: rgba(var(--card-bg-rgb), 0.5); border: 1px solid rgba(var(--u-ink-inv-rgb), 0.1); cursor: pointer; transition: all 150ms ease-in-out; }
.buddy-pill input[type="checkbox"]:checked + label { background-color: rgba(var(--u-primary-rgb), 1); color: white; border-color: rgba(var(--u-accent-rgb), 0.8); transform: scale(1.05); }

/* Group Chat Sender Name */
.message-sender-name { display: block; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.25rem; color: rgba(var(--u-accent-rgb), 0.8); }
.message.sent .message-sender-name { display: none; }

/* Invite Card */
.invite-card { background-color: rgba(var(--card-bg-rgb), 1); border: 1px solid rgba(var(--u-primary-rgb), 0.5); }
.invite-card p { margin-top: 0; }
.invite-card .cta-buttons { flex-direction: row; justify-content: flex-start; }

/* Nav Notification Badge */
.nav-item-messages a { position: relative; }
.notification-badge { position: absolute; top: -5px; right: -12px; display: inline-block; padding: 0.2em 0.5em; font-size: 0.75rem; font-weight: 700; line-height: 1; text-align: center; white-space: nowrap; vertical-align: baseline; border-radius: 999px; background-color: #ef4444; color: white; }

/* Theme Toggle Button */
.theme-toggle {
  background: none;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: rgba(var(--u-ink-inv-rgb), 0.7);
}
.theme-toggle:hover {
  color: rgba(var(--u-ink-inv-rgb), 1);
  background-color: rgba(var(--u-ink-inv-rgb), 0.1);
}
.theme-toggle .icon {
  width: 24px;
  height: 24px;
}
.theme-toggle .icon-sun { display: none; }
.theme-toggle .icon-moon { display: block; }

body.light-mode .theme-toggle .icon-sun { display: block; }
body.light-mode .theme-toggle .icon-moon { display: none; }
